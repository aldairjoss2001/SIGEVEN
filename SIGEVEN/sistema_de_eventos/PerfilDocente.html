<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Perfil Docente - Sistema de Eventos</title>
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/PerfilDocente.css" />
    <!-- Material Icons from Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
      .material-symbols-outlined {
        font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        font-size: inherit;
      }
    </style>
  </head>
  <body>
    <!-- Header/Navigation - Facebook Style -->
    <header class="header">
      <nav class="nav">
        <div class="nav-left">
          <div class="nav-brand">
            <span class="material-symbols-outlined brand-icon">event</span>
            <h2>Eventos EMI</h2>
          </div>
          <div class="nav-search">
            <span class="material-symbols-outlined search-icon">search</span>
            <input type="text" placeholder="Buscar eventos..." class="search-input" id="searchInput">
          </div>
        </div>
        
        <div class="nav-center">
          <a href="PerfilDocente.html" class="nav-menu-item active" title="Inicio">
            <span class="material-symbols-outlined">home</span>
          </a>
          <a href="NuevoEvento.html" class="nav-menu-item" title="Crear Evento">
            <span class="material-symbols-outlined">add_circle</span>
          </a>
          <a href="calendarioDocentes.html" class="nav-menu-item" title="Calendario">
            <span class="material-symbols-outlined">calendar_month</span>
          </a>
          <a href="#estadisticas" class="nav-menu-item" title="Estad√≠sticas">
            <span class="material-symbols-outlined">analytics</span>
          </a>
        </div>
        
        <div class="nav-right">
          <button class="nav-icon-btn" title="Notificaciones">
            <span class="material-symbols-outlined">notifications</span>
            <span class="notification-badge">5</span>
          </button>
          <button class="nav-icon-btn" title="Mensajes">
            <span class="material-symbols-outlined">mail</span>
          </button>
          <div class="nav-profile-dropdown">
            <button class="nav-profile-btn">
              <img src="assets/uploads/avatar-docente.jpeg" alt="Perfil" class="nav-avatar">
              <span class="material-symbols-outlined">expand_more</span>
            </button>
            <div class="dropdown-menu">
              <a href="#perfil" class="dropdown-item">
                <span class="material-symbols-outlined">person</span>
                Mi Perfil
              </a>
              <a href="#configuracion" class="dropdown-item">
                <span class="material-symbols-outlined">settings</span>
                Configuraci√≥n
              </a>
              <div class="dropdown-divider"></div>
              <a href="../logout.php" class="dropdown-item logout">
                <span class="material-symbols-outlined">logout</span>
                Cerrar Sesi√≥n
              </a>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="profile-container">
      <!-- Inputs para tabs (CSS-only) -->
      <input
        type="radio"
        name="profile-tab"
        id="tab-mis-eventos"
        checked
        hidden
      />
      <input type="radio" name="profile-tab" id="tab-solicitudes" hidden />
      <input type="radio" name="profile-tab" id="tab-espacios" hidden />
      <input type="radio" name="profile-tab" id="tab-estadisticas" hidden />

      <!-- Profile Header -->
      <section class="profile-header">
        <div class="cover-photo">
          <img
            src="assets/uploads/portada-docente.jpeg"
            alt="Cover photo"
            class="cover-img"
          />
          <button class="edit-cover-btn" onclick="simularEdicion('portada')">
            ‚úèÔ∏è
          </button>
        </div>

        <div class="profile-info">
          <div class="profile-picture">
            <img
              src="assets/uploads/avatar-docente.jpeg"
              alt="Foto perfil"
              class="profile-img"
              id="profileImage"
            />
            <button class="edit-photo-btn" onclick="simularEdicion('foto')">
              üì∑
            </button>
          </div>

          <div class="profile-details">
            <h1 class="profile-name" id="teacherName">Dr. Carlos Mendoza</h1>
            <p class="profile-bio">Docente de Ingenier√≠a de Sistemas</p>
            <p class="profile-bio">Coordinador de Carrera</p>

            <div class="profile-stats">
              <div class="stat">
                <span class="stat-number" id="eventsCreated">8</span>
                <span class="stat-label">Eventos creados</span>
              </div>
              <div class="stat">
                <span class="stat-number" id="eventsOngoing">3</span>
                <span class="stat-label">En curso</span>
              </div>
              <div class="stat">
                <span class="stat-number" id="totalAttendees">245</span>
                <span class="stat-label">Total asistentes</span>
              </div>
            </div>
          </div>

          <div class="profile-actions">
            <a
              class="btn btn-primary"
              id="btn-nuevo-evento"
              href="NuevoEvento.html"
              >‚ûï Nuevo Evento</a
            >
            <button class="btn btn-outline" onclick="editarPerfil()">
              Editar Perfil
            </button>
          </div>
        </div>
      </section>

      <!-- Navigation Tabs -->
      <section class="profile-tabs">
        <div class="tabs">
          <label
            for="tab-mis-eventos"
            class="tab"
            role="tab"
            aria-controls="mis-eventos"
            >
            <span class="material-symbols-outlined">event_available</span>
            Mis Eventos
          </label>
          <label
            for="tab-solicitudes"
            class="tab"
            role="tab"
            aria-controls="solicitudes"
            >
            <span class="material-symbols-outlined">pending_actions</span>
            Solicitudes
          </label>
          <label
            for="tab-espacios"
            class="tab"
            role="tab"
            aria-controls="espacios"
            >
            <span class="material-symbols-outlined">meeting_room</span>
            Espacios
          </label>
          <label
            for="tab-estadisticas"
            class="tab"
            role="tab"
            aria-controls="estadisticas"
            >
            <span class="material-symbols-outlined">analytics</span>
            Estad√≠sticas
          </label>
        </div>
      </section>

      <!-- Content Area -->
      <section class="profile-content">
        <!-- ========== Mis Eventos (TAB) ========== -->
        <div class="tab-content" id="mis-eventos">
          <div class="section-header">
            <h2>Eventos Creados</h2>
            <p>Gestiona tus actividades y eventos</p>
          </div>

          <div class="events-feed" id="teacherEvents">
            <!-- Los eventos se cargan din√°micamente -->
          </div>
        </div>

        <!-- ========== Solicitudes (TAB) ========== -->
        <div class="tab-content" id="solicitudes">
          <div class="section-header">
            <h2>Solicitudes de Espacios</h2>
            <p>Gestiona tus reservas de espacios universitarios</p>
          </div>

          <div class="requests-grid" id="requestsGrid">
            <!-- Las solicitudes se cargan din√°micamente -->
          </div>
        </div>

        <!-- ========== Espacios (TAB) ========== -->
        <div class="tab-content" id="espacios">
          <div class="section-header">
            <h2>Espacios Disponibles</h2>
            <p>Consulta la disponibilidad de espacios universitarios</p>
          </div>

          <div class="spaces-grid" id="spacesGrid">
            <!-- Los espacios se cargan din√°micamente -->
          </div>
        </div>

        <!-- ========== Estad√≠sticas (TAB) ========== -->
        <div class="tab-content" id="estadisticas">
          <div class="section-header">
            <h2>Estad√≠sticas de Eventos</h2>
            <p>M√©tricas y an√°lisis de tus actividades</p>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <h3>Total de Participantes</h3>
              <div class="stat-number large">245</div>
              <p>Estudiantes en todos tus eventos</p>
            </div>

            <div class="stat-card">
              <h3>√çndice de Ocupaci√≥n</h3>
              <div class="stat-number large">78%</div>
              <p>Promedio de asistencia</p>
            </div>

            <div class="stat-card">
              <h3>Eventos Realizados</h3>
              <div class="stat-number large">8</div>
              <p>Actividades completadas</p>
            </div>

            <div class="stat-card">
              <h3>Satisfacci√≥n</h3>
              <div class="stat-number large">4.5/5</div>
              <p>Calificaci√≥n promedio</p>
            </div>
          </div>

          <div class="charts-section">
            <h3>Asistencia por Evento</h3>
            <div
              class="chart-placeholder"
              style="background: transparent; border: none; padding: 0"
            >
              <div
                class="bar-chart"
                style="
                  display: flex;
                  align-items: flex-end;
                  gap: 18px;
                  height: 220px;
                  padding: 24px 0 8px 0;
                "
              >
                <div
                  style="
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    flex: 1;
                  "
                >
                  <div
                    style="
                      height: 52px;
                      width: 38px;
                      background: #166534;
                      border-radius: 8px 8px 0 0;
                      margin-bottom: 6px;
                      display: flex;
                      align-items: flex-end;
                      justify-content: center;
                      color: white;
                      font-size: 0.95rem;
                      font-weight: 700;
                    "
                  >
                    52
                  </div>
                  <span
                    style="font-size: 0.85rem; color: #374151; margin-top: 4px"
                    >CTF EMI</span
                  >
                </div>
                <div
                  style="
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    flex: 1;
                  "
                >
                  <div
                    style="
                      height: 42px;
                      width: 38px;
                      background: #2563eb;
                      border-radius: 8px 8px 0 0;
                      margin-bottom: 6px;
                      display: flex;
                      align-items: flex-end;
                      justify-content: center;
                      color: white;
                      font-size: 0.95rem;
                      font-weight: 700;
                    "
                  >
                    42
                  </div>
                  <span
                    style="font-size: 0.85rem; color: #374151; margin-top: 4px"
                    >Arborizaci√≥n</span
                  >
                </div>
                <div
                  style="
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    flex: 1;
                  "
                >
                  <div
                    style="
                      height: 156px;
                      width: 38px;
                      background: #eab308;
                      border-radius: 8px 8px 0 0;
                      margin-bottom: 6px;
                      display: flex;
                      align-items: flex-end;
                      justify-content: center;
                      color: #333;
                      font-size: 0.95rem;
                      font-weight: 700;
                    "
                  >
                    156
                  </div>
                  <span
                    style="font-size: 0.85rem; color: #374151; margin-top: 4px"
                    >DEEPTECH</span
                  >
                </div>
                <div
                  style="
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    flex: 1;
                  "
                >
                  <div
                    style="
                      height: 70px;
                      width: 38px;
                      background: #ef4444;
                      border-radius: 8px 8px 0 0;
                      margin-bottom: 6px;
                      display: flex;
                      align-items: flex-end;
                      justify-content: center;
                      color: white;
                      font-size: 0.95rem;
                      font-weight: 700;
                    "
                  >
                    70
                  </div>
                  <span
                    style="font-size: 0.85rem; color: #374151; margin-top: 4px"
                    >Taller Redes</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- /.profile-content -->
    </main>

    <!-- Footer -->
    <footer>
      <p style="color: #fed600">
        ¬© 2025 Sistema de Gesti√≥n de Eventos Universitarios. Todos los derechos
        reservados.
      </p>
    </footer>

    <!-- Modal para acciones -->
    <div id="actionModal" class="modal">
      <div class="modal-content">
        <span class="close-modal" onclick="cerrarModal()">&times;</span>
        <div id="modalContent"></div>
      </div>
    </div>

    <!-- Notificaci√≥n Toast -->
    <div id="toast" class="toast"></div>

    <script>
      // ========== DATOS SIMULADOS ==========
      const teacherData = {
        name: "Dr. Carlos Mendoza",
        department: "Ingenier√≠a de Sistemas",
        role: "Coordinador de Carrera",
        stats: {
          eventsCreated: 8,
          eventsOngoing: 3,
          totalAttendees: 245,
          satisfaction: 4.5,
        },
      };

      const teacherEvents = {
        1: {
          id: 1,
          title: "VII VERSI√ìN CTF EMI 2025",
          type: "ongoing",
          image: "ctf.jpeg",
          date: "10 - 11 Oct 2025 - 18:00",
          location: "Laboratorios de Computaci√≥n - Bloque A",
          description:
            "Sexta versi√≥n de desaf√≠o captura la bandera para estudiantes de sistemas.",
          status: "approved",
          stats: {
            enrolled: 45,
            capacity: 80,
            occupancy: 85,
            waitlist: 12,
          },
        },
        2: {
          id: 2,
          title: "Campa√±a de Arborizaci√≥n",
          type: "upcoming",
          image: "arborizacion.jpeg",
          date: "15 Nov 2025 - 08:00",
          location: "Play√≥n Irpavi",
          description: "Actividad de responsabilidad social universitaria.",
          status: "pending",
          stats: {
            enrolled: 28,
            capacity: 50,
            occupancy: 56,
          },
        },
        3: {
          id: 3,
          title: "Congreso Interuniversitario DEEPTECH",
          type: "completed",
          image: "deeptech.jpeg",
          date: "08 - 09 Sep 2024",
          location: "Auditorio EMI, Irpavi",
          description: "Congreso de tecnolog√≠a e innovaci√≥n para estudiantes.",
          status: "completed",
          stats: {
            totalAttendees: 156,
            satisfaction: 92,
          },
        },
      };

      const spaceRequests = [
        {
          id: 1,
          space: "Sala de Conferencias - Bloque B",
          status: "approved",
          date: "20 Oct 2025",
          time: "14:00 - 17:00",
          activity: "Reuni√≥n de coordinaci√≥n",
          capacity: "30 personas",
        },
        {
          id: 2,
          space: "Laboratorio de Computaci√≥n A-201",
          status: "pending",
          date: "25 Oct 2025",
          time: "08:00 - 12:00",
          activity: "Taller de programaci√≥n",
          capacity: "25 computadoras",
        },
      ];

      const availableSpaces = [
        {
          id: 1,
          name: "Auditorio Principal",
          capacity: "200 personas",
          equipment: "Proyector, Sonido, Aire acondicionado",
          availability: "available",
        },
        {
          id: 2,
          name: "Sal√≥n de Honor",
          capacity: "100 personas",
          equipment: "Proyector, Sonido, Podio",
          availability: "available",
        },
        {
          id: 3,
          name: "Cancha de C√©sped Sint√©tico",
          capacity: "22 personas (f√∫tbol)",
          equipment: "Iluminaci√≥n, Bancas",
          availability: "limited",
        },
        {
          id: 4,
          name: "Parrillero",
          capacity: "40 personas",
          equipment: "Parrillas, Mesas, Sillas",
          availability: "available",
        },
        {
          id: 5,
          name: "Laboratorio de Computaci√≥n A-201",
          capacity: "25 computadoras",
          equipment: "PCs, Proyector, Red",
          availability: "limited",
        },
      ];

      // ========== INICIALIZACI√ìN ==========
      document.addEventListener("DOMContentLoaded", function () {
        inicializarPerfil();
        cargarEventosDocente();
        cargarSolicitudes();
        cargarEspacios();
        cargarEstadisticas();
        configurarBusqueda();
      });

      // ========== FUNCIONES PRINCIPALES ==========

      function inicializarPerfil() {
        document.getElementById("teacherName").textContent = teacherData.name;
        document.getElementById("eventsCreated").textContent =
          teacherData.stats.eventsCreated;
        document.getElementById("eventsOngoing").textContent =
          teacherData.stats.eventsOngoing;
        document.getElementById("totalAttendees").textContent =
          teacherData.stats.totalAttendees;
      }

      function cargarEventosDocente() {
        const container = document.getElementById("teacherEvents");
        if (!container) return;

        container.innerHTML = Object.values(teacherEvents)
          .map(
            (event) => `
        <article class="event-card" data-event-id="${event.id}">
          <div class="event-header">
            <img src="assets/images/${
              event.image
            }" alt="Event image" class="event-cover">
            <div class="event-badge ${
              event.type === "ongoing"
                ? "ongoing"
                : event.type === "completed"
                ? "past"
                : ""
            }">
              ${
                event.type === "ongoing"
                  ? "En Curso"
                  : event.type === "completed"
                  ? "Finalizado"
                  : "Pr√≥ximo"
              }
            </div>
          </div>
          <div class="event-content">
            <div class="event-admin-header">
              <h3 class="event-title">${event.title}</h3>
              <div class="event-actions-admin">
                ${
                  event.status !== "completed"
                    ? `
                  <button class="btn btn-sm btn-edit" onclick="editarEvento(${
                    event.id
                  })">‚úèÔ∏è Editar</button>
                  <button class="btn btn-sm btn-manage" onclick="gestionarEvento(${
                    event.id
                  })">üë• Gestionar</button>
                  ${
                    event.status !== "pending"
                      ? `<button class="btn btn-sm btn-danger" onclick="eliminarEvento(${event.id})">üóëÔ∏è Eliminar</button>`
                      : ""
                  }
                `
                    : `
                  <button class="btn btn-sm btn-outline" onclick="verEstadisticas(${event.id})">üìä Estad√≠sticas</button>
                  <button class="btn btn-sm btn-primary" onclick="gestionarCertificados(${event.id})">üìÑ Certificados</button>
                `
                }
              </div>
            </div>
            <div class="event-meta">
              <span class="event-date">üìÖ ${event.date}</span>
              <span class="event-location">üìç ${event.location}</span>
              <span class="event-status">Estado: <strong>${getStatusText(
                event.status
              )}</strong></span>
            </div>
            <p class="event-description">${event.description}</p>
            <div class="event-stats-admin">
              ${
                event.stats.enrolled
                  ? `
                <div class="stat-admin">
                  <span class="stat-number">${event.stats.enrolled}/${
                      event.stats.capacity
                    }</span>
                  <span class="stat-label">Inscritos</span>
                </div>
                <div class="stat-admin">
                  <span class="stat-number">${event.stats.occupancy}%</span>
                  <span class="stat-label">Ocupaci√≥n</span>
                </div>
                ${
                  event.stats.waitlist
                    ? `
                  <div class="stat-admin">
                    <span class="stat-number">${event.stats.waitlist}</span>
                    <span class="stat-label">En lista de espera</span>
                  </div>
                `
                    : ""
                }
              `
                  : `
                <div class="stat-admin">
                  <span class="stat-number">${event.stats.totalAttendees}</span>
                  <span class="stat-label">Asistentes totales</span>
                </div>
                <div class="stat-admin">
                  <span class="stat-number">${event.stats.satisfaction}%</span>
                  <span class="stat-label">Satisfacci√≥n</span>
                </div>
              `
              }
            </div>
            <div class="event-actions">
              ${
                event.status === "pending"
                  ? `
                <button class="btn btn-outline" onclick="contactarAdministracion(${event.id})">Contactar Administraci√≥n</button>
              `
                  : event.status === "completed"
                  ? `
                <button class="btn btn-primary" onclick="generarReporteFinal(${event.id})">Generar Reporte Final</button>
                <button class="btn btn-outline" onclick="descargarListaAsistencia(${event.id})">Descargar Lista de Asistencia</button>
              `
                  : `
                <button class="btn btn-primary" onclick="verInscritos(${event.id})">Ver Inscritos</button>
                <button class="btn btn-outline" onclick="generarReporte(${event.id})">Generar Reporte</button>
                <button class="btn btn-text" onclick="compartirEvento(${event.id})">üì§ Compartir</button>
              `
              }
            </div>
          </div>
        </article>
      `
          )
          .join("");
      }

      function cargarSolicitudes() {
        const container = document.getElementById("requestsGrid");
        if (!container) return;

        const requestsHTML = spaceRequests
          .map(
            (request) => `
        <div class="request-card ${request.status}">
          <div class="request-header">
            <h3>${request.space}</h3>
            <span class="request-badge ${request.status}">
              ${request.status === "approved" ? "Aprobado" : "Pendiente"}
            </span>
          </div>
          <div class="request-details">
            <p><strong>Fecha:</strong> ${request.date}</p>
            <p><strong>Horario:</strong> ${request.time}</p>
            <p><strong>Actividad:</strong> ${request.activity}</p>
            <p><strong>Capacidad:</strong> ${request.capacity}</p>
          </div>
          <div class="request-actions">
            <button class="btn btn-sm btn-outline" onclick="modificarSolicitud(${
              request.id
            })">
              ${request.status === "pending" ? "Editar" : "Modificar"}
            </button>
            <button class="btn btn-sm btn-danger" onclick="cancelarSolicitud(${
              request.id
            })">
              Cancelar
            </button>
          </div>
        </div>
      `
          )
          .join("");

        // Agregar tarjeta de nueva solicitud
        container.innerHTML =
          requestsHTML +
          `
        <div class="request-card new">
          <div class="request-header">
            <h3>Nueva Solicitud de Evento</h3>
            <span class="request-badge new">Nuevo</span>
          </div>
          <div class="request-details">
            <p>Solicita un espacio para tu pr√≥ximo evento o actividad</p>
          </div>
          <div class="request-actions">
            <button class="btn btn-primary" onclick="nuevaSolicitud()">‚ûï Nuevo Evento</button>
          </div>
        </div>
      `;
      }

      function cargarEspacios() {
        const container = document.getElementById("spacesGrid");
        if (!container) return;

        container.innerHTML = availableSpaces
          .map(
            (space) => `
        <div class="space-card">
          <h3>${space.name}</h3>
          <p>Capacidad: ${space.capacity}</p>
          <p>Equipamiento: ${space.equipment}</p>
          <div class="space-availability">
            <span class="availability-badge ${space.availability}">
              ${
                space.availability === "available"
                  ? "Disponible"
                  : "Ocupado Parcialmente"
              }
            </span>
          </div>
          <button class="btn btn-outline btn-block" onclick="consultarHorarios(${
            space.id
          })">
            Consultar Horarios
          </button>
        </div>
      `
          )
          .join("");
      }

      function cargarEstadisticas() {
        const container = document.getElementById("statsGrid");
        if (!container) return;

        container.innerHTML = `
        <div class="stat-card">
          <h3>Total de Participantes</h3>
          <div class="stat-number large">${teacherData.stats.totalAttendees}</div>
          <p>Estudiantes en todos tus eventos</p>
        </div>
        <div class="stat-card">
          <h3>√çndice de Ocupaci√≥n</h3>
          <div class="stat-number large">78%</div>
          <p>Promedio de asistencia</p>
        </div>
        <div class="stat-card">
          <h3>Eventos Realizados</h3>
          <div class="stat-number large">${teacherData.stats.eventsCreated}</div>
          <p>Actividades completadas</p>
        </div>
        <div class="stat-card">
          <h3>Satisfacci√≥n</h3>
          <div class="stat-number large">${teacherData.stats.satisfaction}/5</div>
          <p>Calificaci√≥n promedio</p>
        </div>
      `;

        // Actualizar gr√°fico de asistencia
        actualizarGraficoAsistencia();
      }

      // ========== FUNCIONES DE GESTI√ìN DE EVENTOS ==========

      function editarEvento(eventId) {
        const event = teacherEvents[eventId];
        if (!event) return;

        if (event.status === "approved") {
          mostrarNotificacion(
            "‚ö†Ô∏è No puedes editar un evento ya aprobado. Contacta a administraci√≥n."
          );
          return;
        }

        mostrarModal(`
        <h3>Editar Evento: ${event.title}</h3>
        <p>Esta funci√≥n te permitir√≠a modificar los detalles del evento.</p>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="guardarCambiosEvento(${eventId})">Guardar Cambios</button>
          <button class="btn btn-outline" onclick="cerrarModal()">Cancelar</button>
        </div>
      `);
      }

      function gestionarEvento(eventId) {
        const event = teacherEvents[eventId];
        if (!event) return;

        mostrarModal(`
        <h3>Gestionar Evento: ${event.title}</h3>
        <div class="management-options">
          <button class="btn btn-outline btn-block" onclick="verInscritos(${eventId})">üë• Ver Lista de Inscritos</button>
          <button class="btn btn-outline btn-block" onclick="enviarRecordatorio(${eventId})">üìß Enviar Recordatorio</button>
          <button class="btn btn-outline btn-block" onclick="gestionarListaEspera(${eventId})">‚è≥ Gestionar Lista de Espera</button>
        </div>
      `);
      }

      function eliminarEvento(eventId) {
        if (
          confirm(
            "¬øEst√°s seguro de que deseas eliminar este evento? Esta acci√≥n no se puede deshacer."
          )
        ) {
          // Simular eliminaci√≥n
          delete teacherEvents[eventId];
          teacherData.stats.eventsCreated--;
          document.getElementById("eventsCreated").textContent =
            teacherData.stats.eventsCreated;

          cargarEventosDocente();
          mostrarNotificacion("‚úÖ Evento eliminado correctamente");
        }
      }

      function verInscritos(eventId) {
        const event = teacherEvents[eventId];
        if (!event) return;

        // Simular lista de inscritos
        const inscritos = [
          "Mar√≠a Fernandez - Ingenier√≠a de Sistemas",
          "Juan P√©rez - Ingenier√≠a Civil",
          "Ana Garc√≠a - Ingenier√≠a Industrial",
          "Carlos L√≥pez - Ingenier√≠a de Sistemas",
        ];

        mostrarModal(`
        <h3>Inscritos en: ${event.title}</h3>
        <div class="inscritos-list">
          <h4>Total: ${event.stats.enrolled} inscritos</h4>
          <ul>
            ${inscritos.map((inscrito) => `<li>${inscrito}</li>`).join("")}
          </ul>
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="exportarListaInscritos(${eventId})">üìä Exportar Lista</button>
          <button class="btn btn-outline" onclick="cerrarModal()">Cerrar</button>
        </div>
      `);
      }

      function generarReporte(eventId) {
        mostrarNotificacion("üìä Generando reporte del evento...");
        setTimeout(() => {
          mostrarNotificacion("‚úÖ Reporte generado y listo para descargar");
        }, 2000);
      }

      // ========== FUNCIONES DE SOLICITUDES ==========

      function modificarSolicitud(requestId) {
        const request = spaceRequests.find((r) => r.id === requestId);
        if (!request) return;

        mostrarModal(`
        <h3>Modificar Solicitud: ${request.space}</h3>
        <p>Aqu√≠ podr√≠as modificar los detalles de tu solicitud de espacio.</p>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="guardarCambiosSolicitud(${requestId})">Guardar Cambios</button>
          <button class="btn btn-outline" onclick="cerrarModal()">Cancelar</button>
        </div>
      `);
      }

      function cancelarSolicitud(requestId) {
        if (confirm("¬øEst√°s seguro de que deseas cancelar esta solicitud?")) {
          const index = spaceRequests.findIndex((r) => r.id === requestId);
          if (index !== -1) {
            spaceRequests.splice(index, 1);
            cargarSolicitudes();
            mostrarNotificacion("‚úÖ Solicitud cancelada correctamente");
          }
        }
      }

      function nuevaSolicitud() {
        // Redirigir a la p√°gina de nuevo evento
        window.location.href = "NuevoEvento.html";
      }

      // ========== FUNCIONES DE ESPACIOS ==========

      function consultarHorarios(spaceId) {
        const space = availableSpaces.find((s) => s.id === spaceId);
        if (!space) return;

        // Simular consulta de horarios
        const horarios = [
          "Lunes: 08:00 - 12:00 (Disponible)",
          "Martes: 14:00 - 18:00 (Ocupado)",
          "Mi√©rcoles: 10:00 - 16:00 (Parcialmente disponible)",
          "Jueves: 08:00 - 12:00 (Disponible)",
          "Viernes: 14:00 - 20:00 (Ocupado)",
        ];

        mostrarModal(`
        <h3>Horarios: ${space.name}</h3>
        <div class="horarios-list">
          ${horarios.map((horario) => `<p>${horario}</p>`).join("")}
        </div>
        <div class="modal-actions">
          <button class="btn btn-primary" onclick="solicitarEsteEspacio(${spaceId})">Solicitar este Espacio</button>
          <button class="btn btn-outline" onclick="cerrarModal()">Cerrar</button>
        </div>
      `);
      }

      // ========== FUNCIONES AUXILIARES ==========

      function getStatusText(status) {
        const statusMap = {
          pending: "Pendiente de aprobaci√≥n",
          approved: "Aprobado",
          completed: "Completado",
        };
        return statusMap[status] || status;
      }

      function simularEdicion(tipo) {
        if (tipo === "foto") {
          mostrarNotificacion("üì∑ Funci√≥n de edici√≥n de foto simulada");
        } else if (tipo === "portada") {
          mostrarNotificacion("üé® Funci√≥n de edici√≥n de portada simulada");
        }
      }

      function editarPerfil() {
        const nuevoNombre = prompt("Editar nombre:", teacherData.name);
        if (nuevoNombre && nuevoNombre.trim() !== "") {
          teacherData.name = nuevoNombre.trim();
          document.getElementById("teacherName").textContent = teacherData.name;
          mostrarNotificacion("‚úÖ Perfil actualizado correctamente");
        }
      }

      function configurarBusqueda() {
        const searchInput = document.getElementById("searchInput");
        if (searchInput) {
          searchInput.addEventListener("input", function (e) {
            const searchTerm = e.target.value.toLowerCase();
            filtrarContenido(searchTerm);
          });
        }
      }

      function filtrarContenido(searchTerm) {
        // Filtrar eventos
        const eventCards = document.querySelectorAll(".event-card");
        eventCards.forEach((card) => {
          const title = card
            .querySelector(".event-title")
            .textContent.toLowerCase();
          const description = card
            .querySelector(".event-description")
            .textContent.toLowerCase();

          if (title.includes(searchTerm) || description.includes(searchTerm)) {
            card.style.display = "flex";
          } else {
            card.style.display = "none";
          }
        });
      }

      function actualizarGraficoAsistencia() {
        const container = document.getElementById("attendanceChart");
        if (!container) return;

        const eventos = Object.values(teacherEvents);
        const asistencias = eventos.map(
          (event) => event.stats.enrolled || event.stats.totalAttendees || 0
        );
        const nombres = eventos.map((event) => event.title.split(" ")[0]);

        container.innerHTML = `
        <div class="bar-chart" style="display:flex; align-items:flex-end; gap:18px; height:220px; padding:24px 0 8px 0;">
          ${asistencias
            .map(
              (asistencia, index) => `
            <div style="display:flex; flex-direction:column; align-items:center; flex:1;">
              <div style="height: ${Math.max(
                30,
                (asistencia / Math.max(...asistencias)) * 150
              )}px; 
                          width:38px; 
                          background:${
                            ["#166534", "#2563eb", "#eab308", "#ef4444"][index]
                          }; 
                          border-radius:8px 8px 0 0; 
                          margin-bottom:6px; 
                          display:flex; 
                          align-items:flex-end; 
                          justify-content:center; 
                          color:white; 
                          font-size:0.95rem; 
                          font-weight:700;">
                ${asistencia}
              </div>
              <span style="font-size:0.85rem; color:#374151; margin-top:4px;">${
                nombres[index]
              }</span>
            </div>
          `
            )
            .join("")}
        </div>
      `;
      }

      function mostrarModal(content) {
        document.getElementById("modalContent").innerHTML = content;
        document.getElementById("actionModal").style.display = "block";
      }

      function cerrarModal() {
        document.getElementById("actionModal").style.display = "none";
      }

      function mostrarNotificacion(mensaje) {
        const toast = document.getElementById("toast");
        toast.textContent = mensaje;
        toast.classList.add("show");

        setTimeout(() => {
          toast.classList.remove("show");
        }, 3000);
      }

      // Cerrar modal al hacer click fuera
      window.onclick = function (event) {
        const modal = document.getElementById("actionModal");
        if (event.target === modal) {
          cerrarModal();
        }
      };
    </script>

    <style>
      /* Estilos para modal */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
      }

      .modal-content {
        background-color: white;
        margin: 10% auto;
        padding: 2rem;
        border-radius: 12px;
        width: 90%;
        max-width: 500px;
        position: relative;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .close-modal {
        position: absolute;
        right: 1rem;
        top: 1rem;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--muted);
      }

      .modal-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
        justify-content: flex-end;
      }

      .management-options {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        margin: 1.5rem 0;
      }

      .inscritos-list ul {
        list-style: none;
        padding: 0;
        margin: 1rem 0;
        max-height: 300px;
        overflow-y: auto;
      }

      .inscritos-list li {
        padding: 0.5rem;
        border-bottom: 1px solid #f1f5f9;
      }

      .horarios-list p {
        padding: 0.5rem;
        margin: 0.25rem 0;
        background: #f8fafc;
        border-radius: 6px;
      }

      /* Estilos para toast */
      .toast {
        visibility: hidden;
        min-width: 250px;
        background-color: #333;
        color: white;
        text-align: center;
        border-radius: 8px;
        padding: 16px;
        position: fixed;
        z-index: 1000;
        left: 50%;
        bottom: 30px;
        transform: translateX(-50%);
        opacity: 0;
        transition: opacity 0.3s, visibility 0.3s;
      }

      .toast.show {
        visibility: visible;
        opacity: 1;
      }

      /* Mejoras para botones */
      .btn-block {
        width: 100%;
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .btn {
        transition: all 0.2s ease;
      }

      .btn:hover:not(:disabled) {
        transform: translateY(-1px);
      }
    </style>
  </body>
</html>
