<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Perfil Estudiante - Sistema de Eventos</title>
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="css/PerfilEstudiante.css" />
</head>
<body>
  <!-- Header/Navigation -->
  <header class="header">
    <nav class="nav">
      <div class="nav-brand"><h2>Eventos EMI</h2></div>
      <div class="nav-search">
        <input type="text" placeholder="Buscar eventos..." class="search-input" id="searchInput">
      </div>
      <div class="nav-icons">
        <a href="calendarioEstudiantes.html" class="nav-icon">CALENDARIO</a>
        <a href="loginEstudiante.html" class="nav-icon">SALIR</a>
      </div>
    </nav>
  </header>

  <!-- Main Content -->
  <main class="profile-container">
    <!-- Inputs para tabs (CSS-only) -->
    <input type="radio" name="profile-tab" id="tab-eventos" checked hidden>
    <input type="radio" name="profile-tab" id="tab-asistidos" hidden>
    <input type="radio" name="profile-tab" id="tab-guardados" hidden>
    <input type="radio" name="profile-tab" id="tab-logros" hidden>
    
    <!-- Profile Header -->
    <section class="profile-header">
      <div class="cover-photo">
        <img src="assets/uploads/portada-estudiante.jpeg" alt="Cover photo" class="cover-img">
        <button class="edit-cover-btn" onclick="simularEdicion('portada')">âœï¸</button>
      </div>

      <div class="profile-info">
        <div class="profile-picture">
          <img src="assets/uploads/avatar-estudiante.jpeg" alt="Foto perfil" class="profile-img" id="profileImage">
          <button class="edit-photo-btn" onclick="simularEdicion('foto')">ğŸ“·</button>
        </div>

        <div class="profile-details">
          <h1 class="profile-name" id="studentName">MarÃ­a Fernandez</h1>
          <p class="profile-bio">Estudiante de IngenierÃ­a de Sistemas</p>
          <p class="profile-bio">6to Semestre</p>

          <div class="profile-stats">
            <div class="stat">
              <span class="stat-number" id="eventsAttended">12</span>
              <span class="stat-label">Eventos asistidos</span>
            </div>
            <div class="stat">
              <span class="stat-number" id="eventsUpcoming">5</span>
              <span class="stat-label">Por asistir</span>
            </div>
            <div class="stat">
              <span class="stat-number" id="certificatesCount">3</span>
              <span class="stat-label">Certificados</span>
            </div>
          </div>
        </div>

        <div class="profile-actions">
          <button class="btn btn-primary" onclick="editarPerfil()">Editar Perfil</button>
          <button class="btn btn-secondary" onclick="mostrarConfiguracion()">ConfiguraciÃ³n</button>
        </div>
      </div>
    </section>

    <!-- Navigation Tabs -->
    <section class="profile-tabs">
      <div class="tabs">
        <label for="tab-eventos" class="tab" role="tab" aria-controls="eventos">ğŸ“… Mis Eventos</label>
        <label for="tab-asistidos" class="tab" role="tab" aria-controls="asistidos">âœ… Asistidos</label>
        <label for="tab-guardados" class="tab" role="tab" aria-controls="guardados">ğŸ”– Guardados</label>
        <label for="tab-logros" class="tab" role="tab" aria-controls="logros">ğŸ† Logros</label>
      </div>
    </section>

    <!-- Content Area -->
    <section class="profile-content">

      <!-- ========== Eventos (TAB) ========== -->
      <div class="tab-content" id="eventos">
        <div class="events-feed" id="eventsFeed">

          <!-- Event Card 1 - CTF (PrÃ³ximo) -->
          <article class="event-card" data-event-id="1" data-event-type="upcoming">
            <div class="event-header">
              <img src="assets/images/ctf.jpeg" alt="Event image" class="event-cover">
              <div class="event-badge">PrÃ³ximo</div>
            </div>
            <div class="event-content">
              <h3 class="event-title">VII VERSIÃ“N CTF EMI 2025</h3>
              <div class="event-meta">
                <span class="event-date">ğŸ“… 10 - 11 Oct 2025 - 18:00</span>
                <span class="event-location">ğŸ“ Laboratorios de Computacion - Bloque A</span>
              </div>
              <p class="event-description">Sexta version de desafio captura la bandera, donde los estudiantes pondrÃ¡n a prueba sus habilidades....</p>
              <div class="event-stats">
                <span class="attendees">ğŸ‘¥ <span id="attendeesCount1">45</span> asistentes confirmados</span>
                <span class="capacity">Capacidad: 80 personas</span>
              </div>
              <div class="event-actions">
                <button class="btn btn-confirm" onclick="confirmarAsistencia(1)">âœ… Confirmar Asistencia</button>
                <button class="btn btn-secondary" onclick="guardarEvento(1)">ğŸ”– Guardar</button>
                <button class="btn btn-text" onclick="compartirEvento(1)">ğŸ“¤ Compartir</button>
              </div>
            </div>
          </article>

          <!-- Event Card 2 - ARBORIZACIÃ“N (En Curso) -->
          <article class="event-card" data-event-id="2" data-event-type="ongoing">
            <div class="event-header">
              <img src="assets/images/arborizacion.jpeg" alt="Event image" class="event-cover">
              <div class="event-badge ongoing">En Curso</div>
            </div>
            <div class="event-content">
              <h3 class="event-title">CampaÃ±a de ArborizaciÃ³n</h3>
              <div class="event-meta">
                <span class="event-date">ğŸ“… 05 Oct 2025</span>
                <span class="event-location">ğŸ“ PlayÃ³n Irpavi</span>
              </div>
              <p class="event-description">Ãšnete a nosotros en la campaÃ±a de arborizaciÃ³n para contribuir al cuidado del medio ambiente...</p>
              <div class="event-status">
                <div class="status-confirmed">âœ… Asistencia confirmada</div>
                <button class="btn btn-outline" onclick="verUbicacion(2)">ğŸ“ Ver ubicaciÃ³n</button>
              </div>
            </div>
          </article>

          <!-- Event Card 3 - DEEPTECH (Finalizado) -->
          <article class="event-card past-event" data-event-id="3" data-event-type="completed">
            <div class="event-header">
              <img src="assets/images/deeptech.jpeg" alt="Event image" class="event-cover">
              <div class="event-badge past">Finalizado</div>
            </div>
            <div class="event-content">
              <h3 class="event-title">Congreso Interuniversitario DEEPTECH</h3>
              <div class="event-meta">
                <span class="event-date">ğŸ“… 08 - 09 Sep 2024</span>
                <span class="event-location">ğŸ“ Auditorio EMI, Irpavi</span>
              </div>
              <p class="event-description">Inteligencia Artificial, Bioingenieria, Ciencia de materiales y mÃ¡s...</p>
              <div class="event-completion">
                <div class="completion-badge">ğŸ† Asistencia completada</div>
                <button class="btn btn-text" onclick="descargarCertificado(3)">ğŸ“„ Descargar certificado</button>
              </div>
            </div>
          </article>

        </div> <!-- /.events-feed -->
      </div> <!-- /#eventos -->

      <!-- ========== Asistidos (TAB) ========== -->
      <div class="tab-content" id="asistidos">
        <div class="events-feed" id="attendedEvents">
          <!-- Los eventos asistidos se cargan dinÃ¡micamente -->
        </div>
      </div>

      <!-- ========== Guardados (TAB) ========== -->
      <div class="tab-content" id="guardados">
        <div class="events-feed" id="savedEvents">
          <!-- Los eventos guardados se cargan dinÃ¡micamente -->
        </div>
      </div>

      <!-- ========== Logros (TAB) ========== -->
      <div class="tab-content" id="logros">
        <div class="section-header">
          <h2>Logros y Certificados</h2>
          <p>Tu progreso acadÃ©mico</p>
        </div>
        <div class="achievements-grid" id="achievementsGrid">
          <!-- Los logros se cargan dinÃ¡micamente -->
        </div>
      </div>

    </section> <!-- /.profile-content -->
  </main>

  <!-- Footer -->
  <footer>
    <p style="color: #fed600">Â© 2025 Sistema de GestiÃ³n de Eventos Universitarios. Todos los derechos reservados.</p>
  </footer>

  <!-- NotificaciÃ³n Toast -->
  <div id="toast" class="toast"></div>

  <script>
    // ========== DATOS SIMULADOS ==========
    const studentData = {
      name: "MarÃ­a Fernandez",
      career: "IngenierÃ­a de Sistemas",
      semester: "6to Semestre",
      stats: {
        attended: 12,
        upcoming: 5,
        certificates: 3
      }
    };

    const eventsData = {
      1: {
        id: 1,
        title: "VII VERSIÃ“N CTF EMI 2025",
        type: "upcoming",
        date: "10 - 11 Oct 2025 - 18:00",
        location: "Laboratorios de Computacion - Bloque A",
        description: "Sexta version de desafio captura la bandera, donde los estudiantes pondrÃ¡n a prueba sus habilidades...",
        attendees: 45,
        capacity: 80,
        confirmed: false,
        saved: false
      },
      2: {
        id: 2,
        title: "CampaÃ±a de ArborizaciÃ³n",
        type: "ongoing",
        date: "05 Oct 2025",
        location: "PlayÃ³n Irpavi",
        description: "Ãšnete a nosotros en la campaÃ±a de arborizaciÃ³n para contribuir al cuidado del medio ambiente...",
        confirmed: true,
        saved: false
      },
      3: {
        id: 3,
        title: "Congreso Interuniversitario DEEPTECH",
        type: "completed",
        date: "08 - 09 Sep 2024",
        location: "Auditorio EMI, Irpavi",
        description: "Inteligencia Artificial, Bioingenieria, Ciencia de materiales y mÃ¡s...",
        attended: true,
        certificate: true,
        saved: false
      }
    };

    const achievementsData = [
      { id: 1, name: "Certificado CTF", date: "12 Oct 2025", type: "certificate" },
      { id: 2, name: "ParticipaciÃ³n DEEPTECH", date: "09 Sep 2024", type: "participation" },
      { id: 3, name: "Voluntariado Ambiental", date: "15 Ago 2024", type: "volunteer" }
    ];

    // ========== ESTADO DE LA APLICACIÃ“N ==========
    let appState = {
      savedEvents: [],
      attendedEvents: [3], // IDs de eventos asistidos
      confirmedEvents: [2] // IDs de eventos confirmados
    };

    // ========== INICIALIZACIÃ“N ==========
    document.addEventListener('DOMContentLoaded', function() {
      inicializarPerfil();
      cargarEventosGuardados();
      cargarEventosAsistidos();
      cargarLogros();
      configurarBusqueda();
    });

    // ========== FUNCIONES PRINCIPALES ==========

    function inicializarPerfil() {
      // Actualizar datos del perfil
      document.getElementById('studentName').textContent = studentData.name;
      document.getElementById('eventsAttended').textContent = studentData.stats.attended;
      document.getElementById('eventsUpcoming').textContent = studentData.stats.upcoming;
      document.getElementById('certificatesCount').textContent = studentData.stats.certificates;
    }

    function confirmarAsistencia(eventId) {
      const event = eventsData[eventId];
      if (!event) return;

      const eventCard = document.querySelector(`[data-event-id="${eventId}"]`);
      const confirmBtn = eventCard.querySelector('.btn-confirm');
      
      if (!appState.confirmedEvents.includes(eventId)) {
        // Confirmar asistencia
        appState.confirmedEvents.push(eventId);
        event.confirmed = true;
        
        // Actualizar UI
        confirmBtn.textContent = 'âœ… Asistencia Confirmada';
        confirmBtn.disabled = true;
        confirmBtn.style.opacity = '0.7';
        
        // Actualizar contador de asistentes
        if (event.attendees !== undefined) {
          event.attendees++;
          document.getElementById(`attendeesCount${eventId}`).textContent = event.attendees;
        }
        
        // Actualizar estadÃ­sticas
        studentData.stats.upcoming--;
        document.getElementById('eventsUpcoming').textContent = studentData.stats.upcoming;
        
        mostrarNotificacion('âœ… Asistencia confirmada exitosamente');
      }
    }

    function guardarEvento(eventId) {
      const event = eventsData[eventId];
      if (!event) return;

      if (!appState.savedEvents.includes(eventId)) {
        // Guardar evento
        appState.savedEvents.push(eventId);
        event.saved = true;
        mostrarNotificacion('ğŸ”– Evento guardado en tus favoritos');
        
        // Actualizar botÃ³n
        const eventCard = document.querySelector(`[data-event-id="${eventId}"]`);
        const saveBtn = eventCard.querySelector('.btn-secondary');
        saveBtn.textContent = 'ğŸ”– Guardado';
        saveBtn.style.background = '#fef3c7';
        saveBtn.style.color = '#92400e';
      } else {
        // Quitar de guardados
        appState.savedEvents = appState.savedEvents.filter(id => id !== eventId);
        event.saved = false;
        mostrarNotificacion('ğŸ—‘ï¸ Evento removido de guardados');
        
        const eventCard = document.querySelector(`[data-event-id="${eventId}"]`);
        const saveBtn = eventCard.querySelector('.btn-secondary');
        saveBtn.textContent = 'ğŸ”– Guardar';
        saveBtn.style.background = '';
        saveBtn.style.color = '';
      }
      
      cargarEventosGuardados();
    }

    function compartirEvento(eventId) {
      const event = eventsData[eventId];
      if (!event) return;

      // Simular compartir
      const shareText = `Â¡Mira este evento: ${event.title} - ${event.date} en ${event.location}`;
      
      if (navigator.share) {
        navigator.share({
          title: event.title,
          text: shareText,
          url: window.location.href
        });
      } else {
        // Fallback para navegadores que no soportan Web Share API
        navigator.clipboard.writeText(shareText).then(() => {
          mostrarNotificacion('ğŸ“‹ Enlace copiado al portapapeles');
        });
      }
    }

    function verUbicacion(eventId) {
      const event = eventsData[eventId];
      if (!event) return;

      // Simular mostrar ubicaciÃ³n en mapa
      mostrarNotificacion(`ğŸ“ Mostrando ubicaciÃ³n: ${event.location}`);
      
      // En un sistema real, aquÃ­ se abrirÃ­a Google Maps o mapa interno
      setTimeout(() => {
        alert(`UbicaciÃ³n del evento:\n${event.location}\n\n(En un sistema real, se abrirÃ­a el mapa)`);
      }, 500);
    }

    function descargarCertificado(eventId) {
      const event = eventsData[eventId];
      if (!event || !event.certificate) return;

      // Simular descarga de certificado
      mostrarNotificacion('ğŸ“„ Preparando descarga del certificado...');
      
      setTimeout(() => {
        mostrarNotificacion('âœ… Certificado descargado exitosamente');
        // En un sistema real, aquÃ­ se iniciarÃ­a la descarga del PDF
      }, 1500);
    }

    // ========== FUNCIONES DE CARGA DE DATOS ==========

    function cargarEventosGuardados() {
      const container = document.getElementById('savedEvents');
      if (!container) return;

      const savedEvents = appState.savedEvents.map(id => eventsData[id]).filter(Boolean);
      
      if (savedEvents.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <p>ğŸ“­ No tienes eventos guardados</p>
            <p style="color: var(--muted); font-size: 0.9rem;">Guarda eventos que te interesen para verlos aquÃ­</p>
          </div>
        `;
        return;
      }

      container.innerHTML = savedEvents.map(event => `
        <article class="event-card">
          <div class="event-header">
            <img src="assets/images/${event.id === 1 ? 'ctf' : event.id === 2 ? 'arborizacion' : 'deeptech'}.jpeg" 
                 alt="Event image" class="event-cover">
            <div class="event-badge">Guardado</div>
          </div>
          <div class="event-content">
            <h3 class="event-title">${event.title}</h3>
            <div class="event-meta">
              <span class="event-date">ğŸ“… ${event.date}</span>
              <span class="event-location">ğŸ“ ${event.location}</span>
            </div>
            <p class="event-description">${event.description}</p>
            <div class="event-actions">
              <button class="btn btn-primary" onclick="confirmarAsistencia(${event.id})">
                âœ… Confirmar Asistencia
              </button>
              <button class="btn btn-secondary" onclick="guardarEvento(${event.id})" 
                      style="background: #fef3c7; color: #92400e;">
                ğŸ”– Guardado
              </button>
            </div>
          </div>
        </article>
      `).join('');
    }

    function cargarEventosAsistidos() {
      const container = document.getElementById('attendedEvents');
      if (!container) return;

      const attendedEvents = appState.attendedEvents.map(id => eventsData[id]).filter(Boolean);
      
      if (attendedEvents.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <p>ğŸ“Š No has asistido a eventos aÃºn</p>
            <p style="color: var(--muted); font-size: 0.9rem;">Tu historial de eventos aparecerÃ¡ aquÃ­</p>
          </div>
        `;
        return;
      }

      container.innerHTML = attendedEvents.map(event => `
        <article class="event-card">
          <div class="event-header">
            <img src="assets/images/${event.id === 1 ? 'ctf' : event.id === 2 ? 'arborizacion' : 'deeptech'}.jpeg" 
                 alt="Event image" class="event-cover">
            <div class="event-badge past">Asistido</div>
          </div>
          <div class="event-content">
            <h3 class="event-title">${event.title}</h3>
            <div class="event-meta">
              <span class="event-date">ğŸ“… ${event.date}</span>
              <span class="event-location">ğŸ“ ${event.location}</span>
            </div>
            <p class="event-description">${event.description}</p>
            <div class="event-actions">
              ${event.certificate ? `
                <button class="btn btn-text" onclick="descargarCertificado(${event.id})">
                  ğŸ“„ Descargar certificado
                </button>
              ` : ''}
              <button class="btn btn-outline" onclick="compartirEvento(${event.id})">
                ğŸ“¤ Compartir experiencia
              </button>
            </div>
          </div>
        </article>
      `).join('');
    }

    function cargarLogros() {
      const container = document.getElementById('achievementsGrid');
      if (!container) return;

      container.innerHTML = achievementsData.map(achievement => `
        <div class="achievement-card" data-achievement-id="${achievement.id}">
          <div class="achievement-icon">
            ${achievement.type === 'certificate' ? 'ğŸ“œ' : 
              achievement.type === 'participation' ? 'ğŸ†' : 'ğŸ¤'}
          </div>
          <div class="achievement-content">
            <strong>${achievement.name}</strong>
            <div style="color: var(--muted); font-size: 0.9rem;">
              Obtenido: ${achievement.date}
            </div>
          </div>
          <button class="btn btn-text" onclick="verDetalleLogro(${achievement.id})">
            ğŸ‘ï¸ Ver
          </button>
        </div>
      `).join('');
    }

    // ========== FUNCIONES AUXILIARES ==========

    function simularEdicion(tipo) {
      if (tipo === 'foto') {
        mostrarNotificacion('ğŸ“· FunciÃ³n de ediciÃ³n de foto simulada');
        // En un sistema real, aquÃ­ se abrirÃ­a el selector de archivos
      } else if (tipo === 'portada') {
        mostrarNotificacion('ğŸ¨ FunciÃ³n de ediciÃ³n de portada simulada');
      }
    }

    function editarPerfil() {
      const nuevoNombre = prompt('Editar nombre:', studentData.name);
      if (nuevoNombre && nuevoNombre.trim() !== '') {
        studentData.name = nuevoNombre.trim();
        document.getElementById('studentName').textContent = studentData.name;
        mostrarNotificacion('âœ… Perfil actualizado correctamente');
      }
    }

    function mostrarConfiguracion() {
      mostrarNotificacion('âš™ï¸ Panel de configuraciÃ³n (simulado)');
      // En un sistema real, aquÃ­ se mostrarÃ­a un modal de configuraciÃ³n
    }

    function verDetalleLogro(achievementId) {
      const achievement = achievementsData.find(a => a.id === achievementId);
      if (achievement) {
        alert(`Logro: ${achievement.name}\nFecha: ${achievement.date}\nTipo: ${achievement.type}`);
      }
    }

    function configurarBusqueda() {
      const searchInput = document.getElementById('searchInput');
      if (searchInput) {
        searchInput.addEventListener('input', function(e) {
          const searchTerm = e.target.value.toLowerCase();
          filtrarEventos(searchTerm);
        });
      }
    }

    function filtrarEventos(searchTerm) {
      const eventCards = document.querySelectorAll('.event-card');
      
      eventCards.forEach(card => {
        const title = card.querySelector('.event-title').textContent.toLowerCase();
        const description = card.querySelector('.event-description').textContent.toLowerCase();
        
        if (title.includes(searchTerm) || description.includes(searchTerm)) {
          card.style.display = 'flex';
        } else {
          card.style.display = 'none';
        }
      });
    }

    function mostrarNotificacion(mensaje) {
      const toast = document.getElementById('toast');
      toast.textContent = mensaje;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

  </script>

  <style>
    /* Estilos para las notificaciones Toast */
    .toast {
      visibility: hidden;
      min-width: 250px;
      background-color: #333;
      color: white;
      text-align: center;
      border-radius: 8px;
      padding: 16px;
      position: fixed;
      z-index: 1000;
      left: 50%;
      bottom: 30px;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s, visibility 0.3s;
    }

    .toast.show {
      visibility: visible;
      opacity: 1;
    }

    /* Estilos para los logros */
    .achievements-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .achievement-card {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      display: flex;
      align-items: center;
      gap: 1rem;
      border-left: 4px solid var(--azul-institucional);
    }

    .achievement-icon {
      font-size: 2rem;
      flex-shrink: 0;
    }

    .achievement-content {
      flex: 1;
    }

    .empty-state {
      text-align: center;
      padding: 3rem;
      color: var(--muted);
      font-style: italic;
    }

    /* Mejoras para botones interactivos */
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .btn {
      transition: all 0.2s ease;
    }

    .btn:hover:not(:disabled) {
      transform: translateY(-1px);
    }
  </style>
</body>
</html>